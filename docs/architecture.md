# Ryze-Data æ¶æ„è®¾è®¡æ–‡æ¡£

## ç›®å½•

- [ç³»ç»Ÿæ¦‚è¿°](#ç³»ç»Ÿæ¦‚è¿°)
- [æ¶æ„åŸåˆ™](#æ¶æ„åŸåˆ™)
- [é¡¹ç›®ç»“æ„](#é¡¹ç›®ç»“æ„)
- [ç³»ç»Ÿæ¶æ„](#ç³»ç»Ÿæ¶æ„)
- [æ ¸å¿ƒæ¨¡å—](#æ ¸å¿ƒæ¨¡å—)
- [æ•°æ®æµè®¾è®¡](#æ•°æ®æµè®¾è®¡)
- [æŠ€æœ¯æ ˆ](#æŠ€æœ¯æ ˆ)
- [æ‰©å±•æ€§è®¾è®¡](#æ‰©å±•æ€§è®¾è®¡)

## ç³»ç»Ÿæ¦‚è¿°

Ryze-Data æ˜¯ä¸€ä¸ªæ¨¡å—åŒ–ã€å¯æ‰©å±•çš„ç§‘å­¦æ–‡çŒ®å¤„ç†æ¡†æ¶ï¼Œé‡‡ç”¨æµæ°´çº¿æ¶æ„è®¾è®¡ï¼Œå°†å¤æ‚çš„æ–‡çŒ®å¤„ç†ä»»åŠ¡åˆ†è§£ä¸ºç‹¬ç«‹çš„å¤„ç†é˜¶æ®µã€‚

### è®¾è®¡ç›®æ ‡

1. **æ¨¡å—åŒ–**ï¼šå„ç»„ä»¶ç‹¬ç«‹å¼€å‘ã€æµ‹è¯•å’Œéƒ¨ç½²
2. **å¯æ‰©å±•**ï¼šæ˜“äºæ·»åŠ æ–°çš„æ•°æ®æºå’Œå¤„ç†æ­¥éª¤
3. **é«˜æ•ˆæ€§**ï¼šæ”¯æŒå¹¶è¡Œå¤„ç†å’Œåˆ†å¸ƒå¼æ‰§è¡Œ
4. **å¯é æ€§**ï¼šé”™è¯¯æ¢å¤å’Œæ–­ç‚¹ç»­ä¼ æœºåˆ¶
5. **å¯è§‚æµ‹**ï¼šå®Œæ•´çš„æ—¥å¿—å’Œç›‘æ§æ”¯æŒ

## æ¶æ„åŸåˆ™

### 1. å•ä¸€èŒè´£åŸåˆ™
æ¯ä¸ªæ¨¡å—è´Ÿè´£ä¸€ä¸ªæ˜ç¡®çš„åŠŸèƒ½ï¼š
- **Scraper**ï¼šæ•°æ®çˆ¬å–
- **OCR Processor**ï¼šæ–‡æ¡£ OCR å¤„ç†
- **API Balancer**ï¼šLLM API è´Ÿè½½å‡è¡¡

### 2. ä¾èµ–å€’ç½®åŸåˆ™
- æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ä¸ä¾èµ–å…·ä½“å®ç°
- é€šè¿‡æ¥å£å’ŒæŠ½è±¡ç±»å®šä¹‰å¥‘çº¦
- é…ç½®é©±åŠ¨çš„ä¾èµ–æ³¨å…¥

### 3. å¼€é—­åŸåˆ™
- å¯¹æ‰©å±•å¼€æ”¾ï¼šæ˜“äºæ·»åŠ æ–°çš„å¤„ç†å™¨
- å¯¹ä¿®æ”¹å…³é—­ï¼šæ ¸å¿ƒæµç¨‹ç¨³å®šä¸å˜

## é¡¹ç›®ç»“æ„

```
Ryze-Data/
â”œâ”€â”€ .env.example                 # ç¯å¢ƒå˜é‡æ¨¡æ¿
â”œâ”€â”€ .env.test                    # æµ‹è¯•ç¯å¢ƒé…ç½®
â”œâ”€â”€ config.example.json          # é…ç½®æ¨¡æ¿ï¼ˆæ”¯æŒç¯å¢ƒå˜é‡ï¼‰
â”œâ”€â”€ config.test.json             # æµ‹è¯•é…ç½®
â”œâ”€â”€ requirements.txt             # Python ä¾èµ–
â”œâ”€â”€ pytest.ini                   # Pytest é…ç½®
â”œâ”€â”€ run_tests.py                 # æµ‹è¯•è¿è¡Œè„šæœ¬
â”œâ”€â”€ README.md                    # é¡¹ç›®æ–‡æ¡£
â”œâ”€â”€ LICENSE                      # AGPL-3.0 è®¸å¯è¯
â”‚
â”œâ”€â”€ src/                         # æºä»£ç ç›®å½•
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ config_manager.py        # é…ç½®ç®¡ç†ï¼ˆæ”¯æŒç¯å¢ƒå˜é‡ï¼‰
â”‚   â”œâ”€â”€ pipeline_manager.py      # æµæ°´çº¿ç¼–æ’å’Œæ‰§è¡Œ
â”‚   â”œâ”€â”€ api_key_balancer.py      # LLM API è´Ÿè½½å‡è¡¡å™¨
â”‚   â”œâ”€â”€ chunked-ocr.py           # åˆ†å— OCR å¤„ç†
â”‚   â”‚
â”‚   â”œâ”€â”€ cli/                     # å‘½ä»¤è¡Œç•Œé¢
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ main.py              # CLI ä¸»å…¥å£
â”‚   â”‚   â””â”€â”€ data_inspector.py    # æ•°æ®æ£€æŸ¥å’Œé‡‡æ ·å·¥å…·
â”‚   â”‚
â”‚   â””â”€â”€ scrapers/                # æ•°æ®æºçˆ¬è™«
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ base.py              # åŸºç¡€çˆ¬è™«æ¥å£
â”‚       â””â”€â”€ nature_scraper.py    # Nature æ–‡ç« çˆ¬è™«
â”‚
â”œâ”€â”€ tests/                       # æµ‹è¯•å¥—ä»¶
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ conftest.py              # æµ‹è¯•å¤¹å…·å’Œé…ç½®
â”‚   â”œâ”€â”€ README.md                # æµ‹è¯•æ–‡æ¡£
â”‚   â”‚
â”‚   â”œâ”€â”€ unit/                    # å•å…ƒæµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ test_config_manager.py
â”‚   â”‚   â””â”€â”€ test_data_inspector.py
â”‚   â”‚
â”‚   â”œâ”€â”€ integration/             # é›†æˆæµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ test_pipeline.py
â”‚   â”‚
â”‚   â””â”€â”€ fixtures/                # æµ‹è¯•æ•°æ®
â”‚       â”œâ”€â”€ sample.pdf
â”‚       â”œâ”€â”€ sample_metadata.csv
â”‚       â””â”€â”€ mock_responses.json
â”‚
â”œâ”€â”€ docs/                        # æ–‡æ¡£
â”‚   â”œâ”€â”€ architecture.md          # æ¶æ„è®¾è®¡æ–‡æ¡£
â”‚   â”œâ”€â”€ api-reference.md         # API æ–‡æ¡£
â”‚   â”œâ”€â”€ configuration.md         # é…ç½®æŒ‡å—
â”‚   â”œâ”€â”€ data-formats.md          # æ•°æ®æ ¼å¼è§„èŒƒ
â”‚   â”œâ”€â”€ development.md           # å¼€å‘æŒ‡å—
â”‚   â”œâ”€â”€ troubleshooting.md       # æ•…éšœæ’é™¤æŒ‡å—
â”‚   â”‚
â”‚   â””â”€â”€ zh-CN/                   # ä¸­æ–‡æ–‡æ¡£
â”‚       â”œâ”€â”€ README.md            # ä¸­æ–‡é¡¹ç›®è¯´æ˜
â”‚       â”œâ”€â”€ architecture.md      # æ¶æ„è®¾è®¡æ–‡æ¡£
â”‚       â”œâ”€â”€ configuration.md     # é…ç½®æŒ‡å—
â”‚       â””â”€â”€ development.md       # å¼€å‘æŒ‡å—
â”‚
â”œâ”€â”€ prompts/                     # LLM æç¤ºè¯æ¨¡æ¿
â”‚   â”œâ”€â”€ text_qa_prompt.txt       # æ–‡æœ¬ QA ç”Ÿæˆæç¤ºè¯
â”‚   â””â”€â”€ vision_qa_prompt.txt     # è§†è§‰ QA ç”Ÿæˆæç¤ºè¯
â”‚
â”œâ”€â”€ data/                        # æ•°æ®ç›®å½•ï¼ˆgit å¿½ç•¥ï¼‰
â”‚   â”œâ”€â”€ nature_metadata/         # çˆ¬å–çš„å…ƒæ•°æ®
â”‚   â”œâ”€â”€ pdfs/                    # ä¸‹è½½çš„ PDF æ–‡ä»¶
â”‚   â”œâ”€â”€ ocr_results/             # OCR å¤„ç†ç»“æœ
â”‚   â”œâ”€â”€ figures/                 # æå–çš„å›¾è¡¨
â”‚   â”œâ”€â”€ sft_data/                # æ–‡æœ¬ QA è®­ç»ƒæ•°æ®
â”‚   â””â”€â”€ vlm_sft_data/            # è§†è§‰ QA è®­ç»ƒæ•°æ®
â”‚
â””â”€â”€ data-sample/                 # æµ‹è¯•ç”¨æ ·æœ¬æ•°æ®
    â”œâ”€â”€ nature_metadata/
    â”‚   â””â”€â”€ sample.csv
    â”œâ”€â”€ pdfs/
    â”‚   â””â”€â”€ sample.pdf
    â””â”€â”€ ocr_results/
        â””â”€â”€ sample/
            â”œâ”€â”€ sample.md
            â””â”€â”€ sample_meta.json
```

### æ–‡ä»¶ç”¨é€”è¯´æ˜

| æ–‡ä»¶/ç›®å½• | ç”¨é€” | å®ç°çŠ¶æ€ |
|-----------|------|----------|
| `src/config_manager.py` | ç»Ÿä¸€é…ç½®ç®¡ç† | âœ… å·²å®ç° |
| `src/pipeline_manager.py` | æµæ°´çº¿ç¼–æ’é€»è¾‘ | âœ… æ¡†æ¶å·²å®ç° |
| `src/api_key_balancer.py` | LLM API è´Ÿè½½å‡è¡¡ | âœ… å·²å®ç° |
| `src/chunked-ocr.py` | åˆ†å— OCR å¤„ç† | âœ… å·²å®ç° |
| `src/cli/main.py` | CLI å‘½ä»¤å®ç° | âœ… å·²å®ç° |
| `src/cli/data_inspector.py` | æ•°æ®æ£€æŸ¥å·¥å…· | âœ… å·²å®ç° |
| `src/scrapers/nature_scraper.py` | Nature æ–‡ç« çˆ¬è™« | âœ… å·²å®ç° |
| `tests/` | å®Œæ•´æµ‹è¯•å¥—ä»¶ | âœ… å·²å®ç° |
| `docs/` | æŠ€æœ¯æ–‡æ¡£ | âœ… å·²å®ç° |

## ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     CLI Interface                        â”‚
â”‚                  (src/cli/main.py)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Pipeline Manager                        â”‚
â”‚              (src/pipeline_manager.py)                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ â€¢ Stage Orchestration                            â”‚   â”‚
â”‚  â”‚ â€¢ Dependency Resolution                          â”‚   â”‚
â”‚  â”‚ â€¢ Error Handling                                 â”‚   â”‚
â”‚  â”‚ â€¢ State Management                               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                      â”‚
    â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
    â”‚ Scrapers â”‚           â”‚ Chunked   â”‚
    â”‚          â”‚           â”‚ OCR       â”‚
    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
          â”‚                      â”‚
    â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚              API Key Balancer                    â”‚
    â”‚           (src/api_key_balancer.py)             â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
    â”‚  â”‚ â€¢ Multi-key Load Balancing             â”‚     â”‚
    â”‚  â”‚ â€¢ Automatic Retry & Fallback           â”‚     â”‚
    â”‚  â”‚ â€¢ Rate Limiting                        â”‚     â”‚
    â”‚  â”‚ â€¢ Statistics & Monitoring              â”‚     â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚           Configuration Manager                  â”‚
    â”‚         (src/config_manager.py)                 â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚              Data Storage                        â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
    â”‚  â”‚ â€¢ File System (Local/NFS)              â”‚     â”‚
    â”‚  â”‚ â€¢ CSV Metadata                         â”‚     â”‚
    â”‚  â”‚ â€¢ Markdown + Images                    â”‚     â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æµæ°´çº¿é˜¶æ®µ

| é˜¶æ®µ | çŠ¶æ€ | æè¿° |
|------|------|------|
| scrape | âœ… å·²å®ç° | ä» Nature ç­‰æ¥æºçˆ¬å–æ–‡ç« å…ƒæ•°æ® |
| ocr | âœ… å·²å®ç° | ä½¿ç”¨ marker å¼•æ“è¿›è¡Œ OCR å¤„ç† |
| download | ğŸ“‹ è®¡åˆ’ä¸­ | PDF æ–‡ä»¶æ‰¹é‡ä¸‹è½½ |
| extract | ğŸ“‹ è®¡åˆ’ä¸­ | å›¾è¡¨å’Œç»“æ„åŒ–å†…å®¹æå– |
| generate-qa | ğŸ“‹ è®¡åˆ’ä¸­ | é—®ç­”å¯¹ç”Ÿæˆ |

## æ ¸å¿ƒæ¨¡å—

### 1. CLI Interface (`src/cli/`)

**èŒè´£**ï¼šæä¾›ç”¨æˆ·äº¤äº’æ¥å£

**ä¸»è¦ç»„ä»¶**ï¼š
- `main.py`ï¼šå‘½ä»¤è¡Œå…¥å£
- `data_inspector.py`ï¼šæ•°æ®æ£€æŸ¥å·¥å…·

**è®¾è®¡æ¨¡å¼**ï¼š
- Command Patternï¼šå‘½ä»¤å°è£…
- Factory Patternï¼šå‘½ä»¤åˆ›å»º

### 2. Pipeline Manager (`src/pipeline_manager.py`)

**èŒè´£**ï¼šåè°ƒå’Œç®¡ç†å¤„ç†æµæ°´çº¿

**æ ¸å¿ƒåŠŸèƒ½**ï¼š
```python
class PipelineManager:
    def __init__(self, config: ConfigManager):
        self.stages = {}  # é˜¶æ®µæ³¨å†Œè¡¨
        self.execution_order = []  # æ‰§è¡Œé¡ºåº

    def add_stage(self, stage: PipelineStage):
        # æ³¨å†Œæ–°é˜¶æ®µ

    def run(self, stages: List[str]):
        # æ‰§è¡ŒæŒ‡å®šé˜¶æ®µ

    def _resolve_dependencies(self):
        # ä¾èµ–è§£æï¼ˆæ‹“æ‰‘æ’åºï¼‰
```

**è®¾è®¡ç‰¹ç‚¹**ï¼š
- å£°æ˜å¼é˜¶æ®µå®šä¹‰
- è‡ªåŠ¨ä¾èµ–è§£æ
- æ”¯æŒé€‰æ‹©æ€§æ‰§è¡Œ
- æ–­ç‚¹ç»­ä¼ æ”¯æŒ

### 3. Configuration Manager (`src/config_manager.py`)

**èŒè´£**ï¼šç»Ÿä¸€é…ç½®ç®¡ç†

**åˆ†å±‚é…ç½®**ï¼š
1. é»˜è®¤é…ç½®ï¼ˆä»£ç ä¸­ï¼‰
2. æ–‡ä»¶é…ç½®ï¼ˆconfig.jsonï¼‰
3. ç¯å¢ƒå˜é‡ï¼ˆ.envï¼‰
4. è¿è¡Œæ—¶å‚æ•°ï¼ˆCLI argsï¼‰

**é…ç½®çƒ­åŠ è½½**ï¼š
```python
config.load()  # åŠ è½½é…ç½®
config.validate()  # éªŒè¯é…ç½®
config.save()  # ä¿å­˜é…ç½®
```

### 4. OpenAI API Balancer (`src/api_key_balancer.py`)

**èŒè´£**ï¼šLLM API è¯·æ±‚è´Ÿè½½å‡è¡¡

**æ ¸å¿ƒåŠŸèƒ½**ï¼š
- å¤š API å¯†é’¥å¹¶å‘å¤„ç†
- è‡ªåŠ¨å¤±è´¥é‡è¯•å’Œ fallback
- è¯·æ±‚é˜Ÿåˆ—ç®¡ç†
- ç»Ÿè®¡ä¿¡æ¯æ”¶é›†

**æ¶æ„è®¾è®¡**ï¼š
```python
class OpenAIAPIBalancer:
    def __init__(self, api_keys: List[str]):
        self.workers = []  # å·¥ä½œçº¿ç¨‹
        self.request_queue = Queue()  # è¯·æ±‚é˜Ÿåˆ—
        self.result_queue = Queue()  # ç»“æœé˜Ÿåˆ—
        self.retry_queue = Queue()  # é‡è¯•é˜Ÿåˆ—

    def submit_chat_completion(self, model, messages, **kwargs):
        # æäº¤èŠå¤©è¯·æ±‚

    def get_statistics(self):
        # è·å–ç»Ÿè®¡ä¿¡æ¯
```

**è¯·æ±‚çŠ¶æ€æµè½¬**ï¼š
```
PENDING â†’ PROCESSING â†’ SUCCESS
                    â†˜ FAILED â†’ RETRYING â†’ SUCCESS/FAILED
```

### 5. Scrapers (`src/scrapers/`)

**èŒè´£**ï¼šæ•°æ®æºçˆ¬å–

**æ‰©å±•æ¥å£**ï¼š
```python
class BaseScraper(ABC):
    @abstractmethod
    def scrape(self) -> List[ArticleMetadata]:
        pass
```

**å·²å®ç°**ï¼š
- `NatureScraper`ï¼šNature æ–‡ç« çˆ¬å–

### 6. Chunked OCR (`src/chunked-ocr.py`)

**èŒè´£**ï¼šå¤§è§„æ¨¡ PDF æ‰¹é‡ OCR å¤„ç†

**æ ¸å¿ƒåŠŸèƒ½**ï¼š
- å¹¶è¡Œå¤„ç†å¤šä¸ª PDF æ–‡ä»¶
- è‡ªåŠ¨åˆ†å—å’Œè¿›åº¦è·Ÿè¸ª
- é”™è¯¯æ¢å¤å’Œé‡è¯•

## æ•°æ®æµè®¾è®¡

### 1. æ•°æ®æµå‘

```
Web Sources â†’ Scrapers â†’ Metadata CSV
                â†“
            OCR Engine â†’ Markdown + Images
                â†“
            (Planned) Processors â†’ Structured Data
                â†“
            (Planned) Generators â†’ Training Data
```

### 2. æ•°æ®æ ¼å¼è½¬æ¢

| é˜¶æ®µ | è¾“å…¥æ ¼å¼ | è¾“å‡ºæ ¼å¼ | çŠ¶æ€ |
|------|---------|----------|------|
| Scraping | HTML | CSV | âœ… å·²å®ç° |
| OCR | PDF | Markdown + Images | âœ… å·²å®ç° |
| Processing | Markdown | Structured JSON | ğŸ“‹ è®¡åˆ’ä¸­ |
| Generation | JSON | JSONL (QA pairs) | ğŸ“‹ è®¡åˆ’ä¸­ |

### 3. æ•°æ®å­˜å‚¨ç­–ç•¥

**æ•°æ®ç»„ç»‡**ï¼š
```
data/
â”œâ”€â”€ nature_metadata/     # å…ƒæ•°æ® CSV
â”‚   â””â”€â”€ articles.csv
â”œâ”€â”€ pdfs/               # åŸå§‹ PDF
â”‚   â””â”€â”€ {paper_id}.pdf
â”œâ”€â”€ ocr_results/        # OCR ç»“æœ
â”‚   â””â”€â”€ {paper_id}/
â”‚       â”œâ”€â”€ {paper_id}.md
â”‚       â”œâ”€â”€ {paper_id}_meta.json
â”‚       â””â”€â”€ images/
â”œâ”€â”€ sft_data/           # æ–‡æœ¬ QAï¼ˆè®¡åˆ’ä¸­ï¼‰
â””â”€â”€ vlm_sft_data/       # è§†è§‰ QAï¼ˆè®¡åˆ’ä¸­ï¼‰
```

## æŠ€æœ¯æ ˆ

### æ ¸å¿ƒæŠ€æœ¯

| ç»„ä»¶ | æŠ€æœ¯é€‰å‹ | è¯´æ˜ |
|------|---------|------|
| è¯­è¨€ | Python 3.8+ | ä¸»å¼€å‘è¯­è¨€ |
| CLI | Click | å‘½ä»¤è¡Œæ¡†æ¶ |
| é…ç½® | python-dotenv | ç¯å¢ƒå˜é‡ç®¡ç† |
| OCR | Marker | PDF è½¬æ¢å¼•æ“ |
| çˆ¬è™« | BeautifulSoup | HTML è§£æ |
| å¹¶è¡Œ | threading/multiprocessing | å¤šçº¿ç¨‹/å¤šè¿›ç¨‹å¤„ç† |
| æµ‹è¯• | pytest | æµ‹è¯•æ¡†æ¶ |

### å¤–éƒ¨ä¾èµ–

| æœåŠ¡ | ç”¨é€” | å¯é€‰æ€§ |
|------|------|--------|
| OpenAI API | QA ç”Ÿæˆ | å¿…éœ€ |
| GPU | OCR åŠ é€Ÿ | å¯é€‰ |

## æ‰©å±•æ€§è®¾è®¡

### 1. è‡ªå®šä¹‰çˆ¬è™«

æ·»åŠ æ–°çš„æ•°æ®æºï¼š

```python
from src.scrapers.base import BaseScraper

class ArxivScraper(BaseScraper):
    def scrape(self):
        # Arxiv çˆ¬å–é€»è¾‘
        return articles

# é…ç½®æ•°æ®æº
config.scrapers.add('arxiv', ArxivScraper)
```

### 2. è‡ªå®šä¹‰å¤„ç†å™¨

æ·»åŠ æ–°çš„å¤„ç†å™¨ï¼ˆéœ€å®ç°ï¼‰ï¼š

```python
class CustomProcessor:
    def process(self, input_data):
        # è‡ªå®šä¹‰å¤„ç†é€»è¾‘
        return processed_data

# æ³¨å†Œåˆ°æµæ°´çº¿
pipeline.add_stage(
    name='custom',
    processor=CustomProcessor(),
    dependencies=['ocr']
)
```

## æ€§èƒ½ä¼˜åŒ–

### 1. å¹¶è¡Œå¤„ç†

- **è¿›ç¨‹çº§å¹¶è¡Œ**ï¼šå¤šè¿›ç¨‹å¤„ç†ä¸åŒæ–‡ä»¶
- **çº¿ç¨‹çº§å¹¶è¡Œ**ï¼šI/O å¯†é›†å‹æ“ä½œï¼ˆAPI è¯·æ±‚ï¼‰
- **å¼‚æ­¥å¤„ç†**ï¼šç½‘ç»œè¯·æ±‚å’Œ API è°ƒç”¨

### 2. API è´Ÿè½½å‡è¡¡

`OpenAIAPIBalancer` æ”¯æŒï¼š
- å¤š API å¯†é’¥è½®è¯¢
- è‡ªåŠ¨å¤±è´¥é‡è¯•ï¼ˆæœ€å¤š 3 æ¬¡ï¼‰
- è¯·æ±‚é™æµï¼ˆæ¯ 10 ä¸ªè¯·æ±‚ä¼‘çœ  1 ç§’ï¼‰
- ç»Ÿè®¡ä¿¡æ¯ç›‘æ§

### 3. æ‰¹å¤„ç†ä¼˜åŒ–

```python
# æ‰¹é‡å¤„ç†é…ç½®
BATCH_SIZES = {
    'ocr': 5,
    'qa_generation': 20  # è®¡åˆ’ä¸­
}
```

## ç›‘æ§å’Œæ—¥å¿—

### 1. æ—¥å¿—åˆ†çº§

| çº§åˆ« | ç”¨é€” | ç¤ºä¾‹ |
|------|------|------|
| DEBUG | è¯¦ç»†è°ƒè¯•ä¿¡æ¯ | å˜é‡å€¼ã€å‡½æ•°è°ƒç”¨ |
| INFO | æ­£å¸¸æµç¨‹ä¿¡æ¯ | é˜¶æ®µå¼€å§‹/ç»“æŸ |
| WARNING | è­¦å‘Šä¿¡æ¯ | è·³è¿‡çš„æ–‡ä»¶ |
| ERROR | é”™è¯¯ä¿¡æ¯ | å¤„ç†å¤±è´¥ |
| CRITICAL | ä¸¥é‡é”™è¯¯ | ç³»ç»Ÿå¼‚å¸¸ |

### 2. ç›‘æ§æŒ‡æ ‡

- **ååé‡**ï¼šæ–‡ä»¶/å°æ—¶
- **æˆåŠŸç‡**ï¼šæˆåŠŸ/æ€»æ•°
- **å»¶è¿Ÿ**ï¼šå¹³å‡å¤„ç†æ—¶é—´
- **èµ„æºä½¿ç”¨**ï¼šCPU/å†…å­˜/ç£ç›˜

### 3. API ç»Ÿè®¡

```python
stats = balancer.get_statistics()
# {
#     "total_requests": 100,
#     "pending_requests": 5,
#     "retry_requests": 2,
#     "completed_results": 93,
#     "workers": [
#         {"thread_id": 0, "processed": 35, "failed": 2},
#         {"thread_id": 1, "processed": 33, "failed": 1},
#         {"thread_id": 2, "processed": 32, "failed": 0}
#     ]
# }
```

## å®‰å…¨æ€§è€ƒè™‘

### 1. API å¯†é’¥ç®¡ç†

- ä½¿ç”¨ç¯å¢ƒå˜é‡å­˜å‚¨
- ä¸åœ¨ä»£ç ä¸­ç¡¬ç¼–ç 
- æ”¯æŒå¯†é’¥è½®æ¢

### 2. æ•°æ®éšç§

- æœ¬åœ°å¤„ç†ä¼˜å…ˆ
- æ•æ„Ÿæ•°æ®è„±æ•
- è®¿é—®æ§åˆ¶

### 3. é”™è¯¯å¤„ç†

- ä¼˜é›…é™çº§
- é”™è¯¯éš”ç¦»
- è‡ªåŠ¨é‡è¯•

## æœªæ¥è§„åˆ’

### çŸ­æœŸç›®æ ‡
1. å®ç° PDF ä¸‹è½½æ¨¡å—
2. å®ç°å›¾è¡¨æå–æ¨¡å—
3. å®ç° QA ç”Ÿæˆæ¨¡å—

### ä¸­æœŸç›®æ ‡
1. æ”¯æŒæ›´å¤šæ•°æ®æºï¼ˆArxivã€PubMedï¼‰
2. æ”¹è¿› OCR ç²¾åº¦
3. Web UI ç•Œé¢

### é•¿æœŸç›®æ ‡
1. åˆ†å¸ƒå¼å¤„ç†æ”¯æŒ
2. æœºå™¨å­¦ä¹ é©±åŠ¨çš„è´¨é‡æ§åˆ¶
3. è‡ªåŠ¨åŒ–æ•°æ®æ ‡æ³¨
